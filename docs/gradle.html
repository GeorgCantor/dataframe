<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-01-25T20:08:33.058095279"/><meta name="build-number" content="449"/>    <meta name="keywords" content="">   <script> (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5P98'); </script><script src="https://resources.jetbrains.com/storage/help-app/v5/analytics.js"></script>  <title>Data Schemas in Gradle projects | Dataframe Documentation</title><script id="virtual-toc-data" type="application/json">[{"id":"configuration","level":0,"title":"Configuration","anchor":"#configuration"},{"id":"annotation-processing","level":0,"title":"Annotation processing","anchor":"#annotation-processing"},{"id":"schema-inference","level":0,"title":"Schema inference","anchor":"#schema-inference"},{"id":"openapi-schemas","level":0,"title":"OpenAPI Schemas","anchor":"#openapi-schemas"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet"/>   <link rel="icon" href="https://resources.jetbrains.com/storage/products/jetbrains/img/icons/favicon.ico" sizes="any"/><!-- 32×32 --><link rel="icon" href="https://resources.jetbrains.com/storage/products/jetbrains/img/icons/icon.svg" type="image/svg+xml"/><link rel="apple-touch-icon" href="https://resources.jetbrains.com/storage/products/jetbrains/img/icons/apple-touch-icon.png"/><!-- 180×180 --><link rel="manifest" href="https://www.jetbrains.com/site.webmanifest"/><meta name="apple-mobile-web-app-title" content="JetBrains"/><meta name="application-name" content="JetBrains"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/>  <meta name="image" content=""/><!-- Open Graph --><meta property="og:title" content="Data Schemas in Gradle projects | Dataframe"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="Dataframe Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://kotlin.github.io/dataframe/0.9/gradle.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content=""/><meta name="twitter:title" content="Data Schemas in Gradle projects | Dataframe"/><meta name="twitter:description" content=""/><meta name="twitter:creator" content=""/><meta name="twitter:image:src" content=""/><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://kotlin.github.io/dataframe/0.9/gradle.html#webpage", "url": "https://kotlin.github.io/dataframe/0.9/gradle.html", "name": "Data Schemas in Gradle projects | Dataframe", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://kotlin.github.io/dataframe/#website", "url": "https://kotlin.github.io/dataframe/", "name": "Dataframe Help" }</script><!-- End Schema.org --></head>    <body data-id="gradle" data-main-title="Data Schemas in Gradle projects" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="overview.md|Overview///schemas.md|Working with Data Schemas"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Dataframe 0.9 Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">  </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="gradle" id="gradle.md"  >Data Schemas in Gradle projects</h1><p id="3d66896b" >In Gradle project <code class="code "   >Kotlin DataFrame</code> provides</p><ol class="list _decimal" id="9dfc93a4"  type="1"  ><li class="list__item" id="f402920d" ><p>Annotation processing for generation of extension properties</p></li><li class="list__item" id="134f8469" ><p>Annotation processing for <code class="code "   >DataSchema</code> inference from datasets.</p></li><li class="list__item" id="6c3f18e8" ><p>Gradle task for <code class="code "   >DataSchema</code> inference from datasets.</p></li></ol><section class="chapter"  ><h2 id="configuration" data-toc="configuration"  >Configuration</h2><p id="3b5fe6f8" >To use <a href="extensionpropertiesapi.html" id="4dc4610b"   >extension properties API</a> in Gradle project you should <a href="installation.html#data-schema-preprocessor" id="c6bd78aa"   >configure Kotlin DataFrame plugin</a>.</p></section><section class="chapter"  ><h2 id="annotation-processing" data-toc="annotation-processing"  >Annotation processing</h2><p id="7b781165" >Declare data schemas in your code and use them to access data in DataFrames. A data schema is a class or interface annotated with <code class="code "   >@DataSchema</code>:</p><div class="code-block" data-lang="kotlin"      data-anchors="[c3aaca92]"     >import org.jetbrains.kotlinx.dataframe.annotations.DataSchema

@DataSchema
interface Person {
    val name: String
    val age: Int
}
</div><section class="chapter"  ><h3 id="execute-kspkotlin-task-to-generate-type-safe-accessors-for-schemas" data-toc="execute-kspkotlin-task-to-generate-type-safe-accessors-for-schemas"  >Execute kspKotlin task to generate type-safe accessors for schemas:</h3><div class="code-block" data-lang="kotlin"      data-anchors="[b1b0e4b8]"     >val df = dataFrameOf(&quot;name&quot;, &quot;age&quot;)(
    &quot;Alice&quot;, 15,
    &quot;Bob&quot;, 20
).cast&lt;Person&gt;()
// age only available after executing `build` or `kspKotlin`!
val teens = df.filter { age in 10..19 }
teens.print()
</div></section></section><section class="chapter"  ><h2 id="schema-inference" data-toc="schema-inference"  >Schema inference</h2><p id="3e8a7170" >Specify schema with preferred method and execute the <code class="code "   >build</code> task.</p><div class="tabs" id="6da8ebd7"data-anchors="[fe79dc7b,d0e3eadc,6f7e547,18f557d4,ac53e90,dcdf813a,7667cb4e,509ea20f,dadff5f3,83927853,6da8ebd7]"><div class="tabs__content" data-gtm="tab" id="fe79dc7b"   data-title="Method 1. Annotation processing" ><p id="d0e3eadc" >ImportDataSchema annotation must be above package directive. You can put this annotation in the same file as data processing code. You can import schema from URL or relative path of the file. Relative path by default is resolved to project root directory. You can configure it by <a href="https://kotlinlang.org/docs/ksp-quickstart.html#pass-options-to-processors" id="2a75d29c"   data-external="true" rel="noopener noreferrer" >passing</a> <code class="code "   >dataframe.resolutionDir</code> option to preprocessor</p><p id="6f7e547" ><b id="d5fc5c75" class=""  >Note that due to incremental processing, imported schema will be re-generated only if some source code has changed from previous invocation, at least one character</b></p><p id="18f557d4" >For the following configuration, file <code class="code "   >Repository.Generated.kt</code> will be generated to <code class="code "   >build/generated/ksp/</code> folder in the same package as file containing the annotation.</p><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[ac53e90]"     >@file:ImportDataSchema(
    &quot;Repository&quot;,
    &quot;https://raw.githubusercontent.com/Kotlin/dataframe/master/data/jetbrains_repositories.csv&quot;,
)

import org.jetbrains.kotlinx.dataframe.annotations.ImportDataSchema
</div><p id="dcdf813a" >See KDocs for <code class="code "   >ImportDataSchema</code> in IDE or <a href="https://github.com/Kotlin/dataframe/blob/master/core/src/main/kotlin/org/jetbrains/kotlinx/dataframe/annotations/ImportDataSchema.kt" id="6a4f5bac"   data-external="true" rel="noopener noreferrer" >github</a> for more details</p></div><div class="tabs__content" data-gtm="tab" id="7667cb4e"   data-title="Method 2. Gradle task" ><p id="509ea20f" >Put this in <code class="code "   >build.gradle</code> or <code class="code "   >build.gradle.kts</code> For the following configuration, file <code class="code "   >Repository.Generated.kt</code> will be generated to <code class="code "   >build/generated/dataframe/org/example</code> folder.</p><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[dadff5f3]"     >dataframes {
    schema {
        data = &quot;https://raw.githubusercontent.com/Kotlin/dataframe/master/data/jetbrains_repositories.csv&quot;
        name = &quot;org.example.Repository&quot;
    }
}
</div><p id="83927853" >See <a href="gradlereference.html" id="9d988d8f"   >reference</a> and <a href="gradlereference.html#examples" id="d53f92de"   >examples</a> for more details.</p></div></div><p id="4ef2dd37" >After <code class="code "   >build</code>, the following code should compile and run:</p><div class="code-block" data-lang="kotlin"      data-anchors="[5ce2c636]"     >// Repository.readCSV() has argument 'path' with default value https://raw.githubusercontent.com/Kotlin/dataframe/master/data/jetbrains_repositories.csv
val df = Repository.readCSV()
// Use generated properties to access data in rows
df.maxBy { stargazersCount }.print()
// Or to access columns in dataframe.
print(df.fullName.count { it.contains(&quot;kotlin&quot;) })
</div></section><section class="chapter"  ><h2 id="openapi-schemas" data-toc="openapi-schemas"  >OpenAPI Schemas</h2><p id="3c6d3ec3" >JSON schema inference is great, but it's not perfect. However, more and more APIs offer <a href="https://swagger.io/" id="cc7c0c4b"   data-external="true" rel="noopener noreferrer" >OpenAPI (Swagger)</a> specifications. Aside from API endpoints, they also hold <a href="https://swagger.io/docs/specification/data-models/" id="f103717c"   data-external="true" rel="noopener noreferrer" >Data Models</a> which include all the information about the types that can be returned from or supplied to the API. Why should we reinvent the wheel and write our own schema inference when we can use the one provided by the API? Not only will we now get the proper names of the types, but we will also get enums, correct inheritance and overall better type safety.</p><p id="79e4660f" >First of all, you will need the extra dependency:</p><div class="code-block" data-lang="kotlin"      data-anchors="[3a7ae698]"     >implementation(&quot;org.jetbrains.kotlinx:dataframe-openapi:$dataframe_version&quot;)
</div><p id="ad7c247c" >OpenAPI type schemas can be generated using both methods described above:</p><div class="code-block" data-lang="kotlin"      data-anchors="[3a83a723]"     >@file:ImportDataSchema(
    path = &quot;https://petstore3.swagger.io/api/v3/openapi.json&quot;,
    name = &quot;PetStore&quot;,
)

import org.jetbrains.kotlinx.dataframe.annotations.ImportDataSchema
</div><div class="code-block" data-lang="kotlin"      data-anchors="[a6b220f6]"     >dataframes {
    schema {
        data = &quot;https://petstore3.swagger.io/api/v3/openapi.json&quot;
        name = &quot;PetStore&quot;
    }
}
</div><p id="1bb920ff" >The only difference is that the name provided is now irrelevant, since the type names are provided by the OpenAPI spec. (If you were wondering, yes, Dataframe can tell the difference between an OpenAPI spec and normal JSON data)</p><p id="6238f392" >After importing the data schema, you can now start to import any JSON data you like using the generated schemas. For instance, one of the types in the schema above is <code class="code "   >PetStore.Pet</code> (which can also be explored <a href="https://petstore3.swagger.io/" id="e54af69"   data-external="true" rel="noopener noreferrer" >here</a>), so let's parse some Pets:</p><div class="code-block" data-lang="kotlin"      data-anchors="[df75100b]"     >val df: DataFrame&lt;PetStore.Pet&gt; =
    PetStore.Pet.readJson(&quot;https://petstore3.swagger.io/api/v3/pet/findByStatus?status=available&quot;)
</div><p id="b9d49934" >Now you will have a correctly typed dataframe!</p><p id="44d860f5" >You can also always ctrl+click on the <code class="code "   >PetStore.Pet</code> type to see all the generated schemas.</p><p id="8d5e60ee" >If you experience any issues with the OpenAPI support (since there are many gotchas and edge-cases when converting something as type-fluid as JSON to a strongly typed language), please open an issue on the <a href="https://github.com/Kotlin/dataframe/issues" id="b4671e8b"   data-external="true" rel="noopener noreferrer" >Github repo</a>.</p></section><div class="last-modified"> Last modified: 25 January 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">   <a class="navigation-links__prev" href="schemas.html">Working with Data Schemas</a>   <a class="navigation-links__next" href="installation.html">Installation</a>   </div></article>  </div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script>  </body></html>