<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-01-25T20:08:34.136739861"/><meta name="build-number" content="449"/>    <meta name="keywords" content="">   <script> (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5P98'); </script><script src="https://resources.jetbrains.com/storage/help-app/v5/analytics.js"></script>  <title>pivot | Dataframe Documentation</title><script id="virtual-toc-data" type="application/json">[{"id":"pivot-groupby","level":0,"title":"pivot + groupBy","anchor":"#pivot-groupby"},{"id":"aggregation","level":0,"title":"Aggregation","anchor":"#aggregation"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet"/>   <link rel="icon" href="https://resources.jetbrains.com/storage/products/jetbrains/img/icons/favicon.ico" sizes="any"/><!-- 32×32 --><link rel="icon" href="https://resources.jetbrains.com/storage/products/jetbrains/img/icons/icon.svg" type="image/svg+xml"/><link rel="apple-touch-icon" href="https://resources.jetbrains.com/storage/products/jetbrains/img/icons/apple-touch-icon.png"/><!-- 180×180 --><link rel="manifest" href="https://www.jetbrains.com/site.webmanifest"/><meta name="apple-mobile-web-app-title" content="JetBrains"/><meta name="application-name" content="JetBrains"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/>  <meta name="image" content=""/><!-- Open Graph --><meta property="og:title" content="pivot | Dataframe"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="Dataframe Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://kotlin.github.io/dataframe/0.9/pivot.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content=""/><meta name="twitter:title" content="pivot | Dataframe"/><meta name="twitter:description" content=""/><meta name="twitter:creator" content=""/><meta name="twitter:image:src" content=""/><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://kotlin.github.io/dataframe/0.9/pivot.html#webpage", "url": "https://kotlin.github.io/dataframe/0.9/pivot.html", "name": "pivot | Dataframe", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://kotlin.github.io/dataframe/#website", "url": "https://kotlin.github.io/dataframe/", "name": "Dataframe Help" }</script><!-- End Schema.org --></head>    <body data-id="pivot" data-main-title="pivot" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="operations.md|Operations///modify.md|Modify///pivotGather.md|Pivot/gather columns"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Dataframe 0.9 Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">  </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="pivot" id="pivot.md"  >pivot</h1><p id="fd276a4c" >Splits the rows of <code class="code "   >DataFrame</code> and groups them horizontally into new columns based on values from one or several columns of original <code class="code "   >DataFrame</code>.</p><div class="code-block" data-lang="plaintext"      data-anchors="[ff0644a0]"     >pivot (inward = true) { pivotColumns }
  [ .groupBy { indexColumns } | .groupByOther() ]
  [ .default(defaultValue) ]
     reducer | aggregator
    
reducer = .minBy { column } | .maxBy { column } | .first [ { rowCondition } ] | .last [ { rowCondition } ] 
          .with { rowExpression } | .values { valueColumns }

aggregator = .count() | .matches() | .frames() | .with { rowExpression } | .values { valueColumns } | .aggregate { aggregations } | .&lt;stat&gt; [ { columns } ]
</div><p id="758e180d" ><b id="16ad6e96" class=""  >Parameters:</b></p><ul class="list _bullet" id="c0dc8228"    ><li class="list__item" id="12d9547" ><p><code class="code "   >inward</code> — if <code class="code "   >true</code> generated columns will be nested inside original column, otherwise they will be top-level</p></li><li class="list__item" id="2481bdd2" ><p><code class="code "   >pivotColumns</code> — columns with values for horizontal data grouping and generation of new columns</p></li><li class="list__item" id="c4c4ebc7" ><p><code class="code "   >indexColumns</code> — columns with values for vertical data grouping</p></li><li class="list__item" id="29a43d8a" ><p><code class="code "   >defaultValue</code> — value to fill mismatched pivot-index column pairs</p></li><li class="list__item" id="4d67ef89" ><p><code class="code "   >valueColumns</code> — columns with output values</p></li></ul><div class="tabs" id="5848778"data-anchors="[f82ae72b,9a5ade09,e199be0c,2999283d,767faa6e,7f0123c5,5848778]"><div class="tabs__content" data-gtm="tab" id="f82ae72b"   data-title="Properties" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[9a5ade09]"     >df.pivot { city }
</div></div><div class="tabs__content" data-gtm="tab" id="e199be0c"   data-title="Accessors" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[2999283d]"     >val city by column&lt;String?&gt;()

df.pivot { city }
</div></div><div class="tabs__content" data-gtm="tab" id="767faa6e"   data-title="Strings" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[7f0123c5]"     >df.pivot(&quot;city&quot;)
</div></div></div><p id="10bde9bf" >To pivot several columns at once you can combine them using <code class="code "   >and</code> or <code class="code "   >then</code> infix function:</p><ul class="list _bullet" id="9cf9d9fd"    ><li class="list__item" id="e1f8d913" ><p><code class="code "   >and</code> will pivot columns independently</p></li><li class="list__item" id="7e72c7f9" ><p><code class="code "   >then</code> will create column hierarchy from combinations of values from pivoted columns</p></li></ul><div class="tabs" id="7c12c778"data-anchors="[f1071a73,a4a56e8b,97b49913,a918ac12,25ca5d3a,3e99e58e,7c12c778]"><div class="tabs__content" data-gtm="tab" id="f1071a73"   data-title="Properties" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[a4a56e8b]"     >df.pivot { city and name.firstName }
df.pivot { city then name.firstName }
</div></div><div class="tabs__content" data-gtm="tab" id="97b49913"   data-title="Accessors" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[a918ac12]"     >val city by column&lt;String?&gt;()
val name by columnGroup()
val firstName by name.column&lt;String&gt;()

df.pivot { city and firstName }
df.pivot { city then firstName }
</div></div><div class="tabs__content" data-gtm="tab" id="25ca5d3a"   data-title="Strings" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[3e99e58e]"     >df.pivot { &quot;city&quot; and &quot;name&quot;[&quot;firstName&quot;] }
df.pivot { &quot;city&quot; then &quot;name&quot;[&quot;firstName&quot;] }
</div></div></div><section class="chapter"  ><h2 id="pivot-groupby" data-toc="pivot-groupby"  >pivot + groupBy</h2><p id="6fc3c5ac" >To create matrix table that is expanded both horizontally and vertically, apply <code class="code "   >groupBy</code> transformation passing the columns for vertical grouping. Reversed order of <code class="code "   >pivot</code> and <code class="code "   >groupBy</code> will produce the same result.</p><div class="tabs" id="2b10a77e"data-anchors="[c0ad578d,680b8d90,ad5787d4,f98408dc,f2685562,a8811d04,2b10a77e]"><div class="tabs__content" data-gtm="tab" id="c0ad578d"   data-title="Properties" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[680b8d90]"     >df.pivot { city }.groupBy { name }
// same as
df.groupBy { name }.pivot { city }
</div></div><div class="tabs__content" data-gtm="tab" id="ad5787d4"   data-title="Accessors" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[f98408dc]"     >val city by column&lt;String?&gt;()
val name by columnGroup()

df.pivot { city }.groupBy { name }
// same as
df.groupBy { name }.pivot { city }
</div></div><div class="tabs__content" data-gtm="tab" id="f2685562"   data-title="Strings" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[a8811d04]"     >df.pivot(&quot;city&quot;).groupBy(&quot;name&quot;)
// same as
df.groupBy(&quot;name&quot;).pivot(&quot;city&quot;)
</div></div></div><p id="b517c6cb" >To group by all columns except pivoted use <code class="code "   >groupByOther</code>:</p><div class="code-block" data-lang="kotlin"      data-anchors="[dbac8bfd]"     >df.pivot { city }.groupByOther()
</div></section><section class="chapter"  ><h2 id="aggregation" data-toc="aggregation"  >Aggregation</h2><p id="6227fa4f" >To aggregate data groups with one or several statistics use <code class="code "   >aggregate</code>:</p><div class="tabs" id="4b5b9016"data-anchors="[6d84e124,b8e3fd8d,379b0352,d2838bf2,112c144e,e19b21f8,4b5b9016]"><div class="tabs__content" data-gtm="tab" id="6d84e124"   data-title="Properties" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[b8e3fd8d]"     >df.pivot { city }.aggregate { minBy { age }.name }
df.pivot { city }.groupBy { name.firstName }.aggregate {
    meanFor { age and weight } into &quot;means&quot;
    stdFor { age and weight } into &quot;stds&quot;
    maxByOrNull { weight }?.name?.lastName into &quot;biggest&quot;
}
</div></div><div class="tabs__content" data-gtm="tab" id="379b0352"   data-title="Accessors" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[d2838bf2]"     >val city by column&lt;String?&gt;()
val name by columnGroup()
val firstName by name.column&lt;String&gt;()
val age by column&lt;Int&gt;()
val weight by column&lt;Int?&gt;()

df.pivot { city }.aggregate { minBy(age).name }

df.pivot { city }.groupBy { firstName }.aggregate {
    meanFor { age and weight } into &quot;means&quot;
    stdFor { age and weight } into &quot;stds&quot;
    maxByOrNull(weight)?.name?.lastName into &quot;biggest&quot;
}
</div></div><div class="tabs__content" data-gtm="tab" id="112c144e"   data-title="Strings" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[e19b21f8]"     >df.pivot(&quot;city&quot;).aggregate { minBy(&quot;age&quot;)[&quot;name&quot;] }

df.pivot(&quot;city&quot;).groupBy { &quot;name&quot;[&quot;firstName&quot;] }.aggregate {
    meanFor(&quot;age&quot;, &quot;weight&quot;) into &quot;means&quot;
    stdFor(&quot;age&quot;, &quot;weight&quot;) into &quot;stds&quot;
    maxByOrNull(&quot;weight&quot;)?.getColumnGroup(&quot;name&quot;)?.get(&quot;lastName&quot;) into &quot;biggest&quot;
}
</div></div></div><p id="59e21aeb" >Shortcuts for common aggregation functions are also available:</p><div class="tabs" id="66e3f25"data-anchors="[8db16252,d652f18d,1c5af938,8cd2a0b6,2f973061,f34686ee,66e3f25]"><div class="tabs__content" data-gtm="tab" id="8db16252"   data-title="Properties" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[d652f18d]"     >df.pivot { city }.maxFor { age and weight }
df.groupBy { name }.pivot { city }.median { age }
</div></div><div class="tabs__content" data-gtm="tab" id="1c5af938"   data-title="Accessors" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[8cd2a0b6]"     >val city by column&lt;String?&gt;()
val name by columnGroup()
val age by column&lt;Int&gt;()
val weight by column&lt;Int?&gt;()

df.pivot { city }.maxFor { age and weight }
df.groupBy { name }.pivot { city }.median { age }
</div></div><div class="tabs__content" data-gtm="tab" id="2f973061"   data-title="Strings" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[f34686ee]"     >df.pivot(&quot;city&quot;).maxFor(&quot;age&quot;, &quot;weight&quot;)
df.groupBy(&quot;name&quot;).pivot(&quot;city&quot;).median(&quot;age&quot;)
</div></div></div><p id="22007e6c" >By default, when aggregation function produces several values for single data group, column hierarchy in resulting <code class="code "   >DataFrame</code> will be indexed first by pivot keys and then by the names of aggregated values. To reverse this order so that resulting columns will be indexed first by names of aggregated values and then by pivot keys, use <code class="code "   >separate=true</code> flag that is available in multi-result aggregation operations, such as <code class="code "   >aggregate</code> or <code class="code "   >&lt;stat&gt;For</code>:</p><div class="tabs" id="625dfb43"data-anchors="[2e44bf8b,5890c7fa,3803d8fc,7a03330f,54384cce,71ae54ae,625dfb43]"><div class="tabs__content" data-gtm="tab" id="2e44bf8b"   data-title="Properties" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[5890c7fa]"     >df.pivot { city }.maxFor(separate = true) { age and weight }
df.pivot { city }.aggregate(separate = true) {
    min { age } into &quot;min age&quot;
    maxOrNull { weight } into &quot;max weight&quot;
}
</div></div><div class="tabs__content" data-gtm="tab" id="3803d8fc"   data-title="Accessors" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[7a03330f]"     >val city by column&lt;String?&gt;()
val age by column&lt;Int&gt;()
val weight by column&lt;Int?&gt;()

df.pivot { city }.maxFor(separate = true) { age and weight }
df.pivot { city }.aggregate(separate = true) {
    min { age } into &quot;min age&quot;
    maxOrNull { weight } into &quot;max weight&quot;
}
</div></div><div class="tabs__content" data-gtm="tab" id="54384cce"   data-title="Strings" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[71ae54ae]"     >df.pivot(&quot;city&quot;).maxFor(&quot;age&quot;, &quot;weight&quot;, separate = true)
df.pivot(&quot;city&quot;).aggregate(separate = true) {
    min(&quot;age&quot;) into &quot;min age&quot;
    maxOrNull(&quot;weight&quot;) into &quot;max weight&quot;
}
</div></div></div><p id="4c80fc60" >By default, any aggregation function will result in <code class="code "   >null</code> value for those matrix cells, where intersection of column and row keys produced an empty data group. You can specify default value for any aggregation by <code class="code "   >default</code> infix function. This value will replace all <code class="code "   >null</code> results of aggregation function over non-empty data groups as well. To use one default value for all aggregation functions, use <code class="code "   >default()</code> before aggregation.</p><div class="tabs" id="7b230418"data-anchors="[7bbf34e,f60b1147,2dad0f56,6904359a,7e1780ba,1ec6a68,7b230418]"><div class="tabs__content" data-gtm="tab" id="7bbf34e"   data-title="Properties" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[f60b1147]"     >df.pivot { city }.groupBy { name }.aggregate { min { age } default 0 }
df.pivot { city }.groupBy { name }.aggregate {
    median { age } into &quot;median age&quot; default 0
    minOrNull { weight } into &quot;min weight&quot; default 100
}
df.pivot { city }.groupBy { name }.default(0).min()
</div></div><div class="tabs__content" data-gtm="tab" id="2dad0f56"   data-title="Accessors" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[6904359a]"     >val city by column&lt;String?&gt;()
val age by column&lt;Int&gt;()
val weight by column&lt;Int?&gt;()
val name by columnGroup()

df.pivot { city }.groupBy { name }.aggregate { min { age } default 0 }
df.pivot { city }.groupBy { name }.aggregate {
    median { age } into &quot;median age&quot; default 0
    minOrNull { weight } into &quot;min weight&quot; default 100
}
df.pivot { city }.groupBy { name }.default(0).min()
</div></div><div class="tabs__content" data-gtm="tab" id="7e1780ba"   data-title="Strings" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[1ec6a68]"     >df.pivot(&quot;city&quot;).groupBy(&quot;name&quot;).aggregate { min(&quot;age&quot;) default 0 }
df.pivot(&quot;city&quot;).groupBy(&quot;name&quot;).aggregate {
    median(&quot;age&quot;) into &quot;median age&quot; default 0
    minOrNull(&quot;weight&quot;) into &quot;min weight&quot; default 100
}
df.pivot(&quot;city&quot;).groupBy(&quot;name&quot;).default(0).min()
</div></div></div><section class="chapter"  ><h3 id="pivot-inside-aggregate" data-toc="pivot-inside-aggregate"  >Pivot inside aggregate</h3><p id="7c578303" ><span id="12c65e53" >pivot</span> transformation can be used inside <a href="groupby.html#aggregation" id="27e01e9b"   ><code class="code "   >aggregate</code></a> function of <a href="groupby.html" id="f7ea8410"   ><code class="code "   >GroupBy</code></a>. This allows to combine column pivoting with other <a href="groupby.html" id="fe9f6d2b"   ><code class="code "   >groupBy</code></a> aggregations:</p><div class="tabs" id="af668dca"data-anchors="[c7f2c522,1d5081d0,26c216c7,3120daba,48fed75e,f021468e,af668dca]"><div class="tabs__content" data-gtm="tab" id="c7f2c522"   data-title="Properties" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[1d5081d0]"     >df.groupBy { name.firstName }.aggregate {
    pivot { city }.aggregate(separate = true) {
        mean { age } into &quot;mean age&quot;
        count() into &quot;count&quot;
    }
    count() into &quot;total&quot;
}
</div></div><div class="tabs__content" data-gtm="tab" id="26c216c7"   data-title="Accessors" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[3120daba]"     >val city by column&lt;String?&gt;()
val name by columnGroup()
val firstName by name.column&lt;String&gt;()
val age by column&lt;Int&gt;()

df.groupBy { firstName }.aggregate {
    pivot { city }.aggregate(separate = true) {
        mean { age } into &quot;mean age&quot;
        count() into &quot;count&quot;
    }
    count() into &quot;total&quot;
}
</div></div><div class="tabs__content" data-gtm="tab" id="48fed75e"   data-title="Strings" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"  data-anchors="[f021468e]"     >df.groupBy { &quot;name&quot;[&quot;firstName&quot;] }.aggregate {
    pivot(&quot;city&quot;).aggregate(separate = true) {
        mean(&quot;age&quot;) into &quot;mean age&quot;
        count() into &quot;count&quot;
    }
    count() into &quot;total&quot;
}
</div></div></div></section><section class="chapter"  ><h3 id="pivotcounts" data-toc="pivotcounts"  >pivotCounts</h3><p id="19324a51" >Pivots with <a href="count.html" id="a4e133e"   ><code class="code "   >count</code></a> statistics one or several columns preserving all other columns of <code class="code "   >DataFrame</code> or <code class="code "   >GroupBy</code>.</p><div class="code-block" data-lang="kotlin"      data-anchors="[8370d154]"     >df.pivotCounts { city }
// same as
df.pivot { city }.groupByOther().count()

df.groupBy { name }.pivotCounts { city }
// same as
df.groupBy { name }.pivot { city }.count()
// same as
df.groupBy { name }.aggregate {
    pivotCounts { city }
}
</div></section><section class="chapter"  ><h3 id="pivotmatches" data-toc="pivotmatches"  >pivotMatches</h3><p id="342d5094" >Pivots with <code class="code "   >Boolean</code> statistics one or several columns preserving all other columns of <code class="code "   >DataFrame</code>.</p><div class="code-block" data-lang="kotlin"      data-anchors="[5b0c0db9]"     >df.pivotMatches { city }
// same as
df.pivot { city }.groupByOther().matches()

df.groupBy { name }.pivotMatches { city }
// same as
df.groupBy { name }.pivot { city }.matches()
// same as
df.groupBy { name }.aggregate {
    pivotMatches { city }
}
</div></section></section><div class="last-modified"> Last modified: 25 January 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">   <a class="navigation-links__prev" href="pivotgather.html">Pivot/gather columns</a>   <a class="navigation-links__next" href="gather.html">gather</a>   </div></article>  </div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script>  </body></html>